setwd("C:/Users/manue/OneDrive - Universidad Alberto Hurtado/8vo_semestre/ayu_econometria/data");
library("openxlsx");
library(qcc);
library(modeest);
library(psych);
library(moments)
library(moments)
datos1 <- read.xlsx("Ejemplo1.xlsx",sheet="Hoja1", colNames = TRUE);
View(datos1)
total <- sum(datos1$Frecuencia);
datos1$relativa <- datos1$Frecuencia/total;
datos1$relativa <- datos1$Frecuencia/total;
total <- sum(datos1$Frecuencia);# suma de los datos de frecuencia
datos1$relativa <- datos1$Frecuencia/total;
View(datos1)
relativo <- t(as.data.frame(datos1$relativa));
colnames(relativo) <- datos1$Categoria;
barplot(relativo, xlab = "Accidentes", ylab = "Frecuencia", las=2);
relativo2 <- datos1$relativa;
names(relativo2) <- datos1$Categoria;
par(mar = rep(2, 4));
pareto.chart(relativo2)
datos2 <- read.xlsx("Ejemplo2.xlsx",sheet="Hoja1", colNames=TRUE);
milla <- 1.6093;
galon <- 3.78;
factorconversion <- milla/galon;
datos2$EPA_Mileage_Ratings_km_l <- factorconversion * datos2$EPA_Mileage_Ratings_milla_galon;
plot(datos2$EPA_Mileage_Ratings_km_l);
hist(datos2$EPA_Mileage_Ratings_km_l, main = "Histograma de frecuencias EPA", xlab = "km_lt", freq = FALSE)
plot(density(datos2$EPA_Mileage_Ratings_km_l), main = "Densidad de frecuencias EPA", xlab = "km_lt")
curve(dnorm(x, mean=mean(datos2$EPA_Mileage_Ratings_km_l, na.rm=T), sd=sd(datos2$EPA_Mileage_Ratings_km_l,na.rm=T)),
add=TRUE, col="red");
boxplot(datos2$EPA_Mileage_Ratings_km_l, main = "Gráfico de cajas 1",
outline = TRUE)
mean(datos2$EPA_Mileage_Ratings_km_l)
median(datos2$EPA_Mileage_Ratings_km_l)
mfv(datos2$EPA_Mileage_Ratings_km_l)
range(datos2$EPA_Mileage_Ratings_km_l, na.rm = TRUE)
sd(datos2$EPA_Mileage_Ratings_km_l, na.rm = TRUE)
coeficiente_variacion <- sd(datos2$EPA_Mileage_Ratings_km_l, na.rm = TRUE)/mean(datos2$EPA_Mileage_Ratings_km_l)
shapiro.test(datos2$EPA_Mileage_Ratings_km_l)
ks.test(datos2$EPA_Mileage_Ratings_km_l, pnorm, mean(datos2$EPA_Mileage_Ratings_km_l, na.rm=T), sd(datos2$EPA_Mileage_Ratings_km_l,na.rm=T))
datos_simulados <- rnorm(1000, mean=mean(datos2$EPA_Mileage_Ratings_km_l, na.rm=T), sd=sd(datos2$EPA_Mileage_Ratings_km_l,na.rm=T))
hist(datos_simulados);
hist(datos2$EPA_Mileage_Ratings_km_l, freq=FALSE);
curve(dnorm(x, mean=mean(datos2$EPA_Mileage_Ratings_km_l, na.rm=T), sd=sd(datos2$EPA_Mileage_Ratings_km_l,na.rm=T)),
add=TRUE, col="red");
quantile(datos2$EPA_Mileage_Ratings_km_l, prob=c(0,0.25,0.5,0.75,1))
z_0.75 <- mean(datos2$EPA_Mileage_Ratings_km_l, na.rm=T)+qnorm(0.75)*sd(datos2$EPA_Mileage_Ratings_km_l,na.rm=T);
z_0.25 <- mean(datos2$EPA_Mileage_Ratings_km_l, na.rm=T)+qnorm(0.25)*sd(datos2$EPA_Mileage_Ratings_km_l,na.rm=T);
qqnorm(datos2$EPA_Mileage_Ratings_km_l)
skewness(datos2$EPA_Mileage_Ratings_km_l)
kurtosis(datos2$EPA_Mileage_Ratings_km_l)
plot(density(datos2$EPA_Mileage_Ratings_km_l), main = "Densidad de frecuencias EPA", xlab = "km_lt")
curve(dnorm(x, mean=mean(datos2$EPA_Mileage_Ratings_km_l, na.rm=T), sd=sd(datos2$EPA_Mileage_Ratings_km_l,na.rm=T)),
add=TRUE, col="red");
library(psych)
install.packages("psych")
library(psych)
install.packages("scatterplot3d")
library(scatterplot3d)
install.packages("readxl")
# SECCION A ---------------------------------------------------------------
p <- as.Date("2022-08-22")
q <- as.Date("2019-04-21")
r <- as.Date("2023-03-16")
s <- as.Date("2021-06-16")
t <- as.Date("2020-04-18")
Nombres <- c("manuel", "daniel", "roberto", "alfonso", "jaime", "ignacio", "andres", "maximiliano", "patricio",
"josue", "alejandro", "felipe", "Tulio", "humberto","nelson")
"Horas extras diarias" <- c(6,8,9,5,2,4,7,1,2,3,6,5,3,2,1)
"Horas de trabajo semanales" <- c(48,56,52,49,60,48,58,49,50,46,48,49,40,50,66) #Horas semanales
"Comuna de residencia"<- c("maipu","maipu","pudahuel","cerrillos","lampa","san miguel","quilicura","quilicura","san miguel","el castillo","santiago","lampa","el bosque","la pintana","ñuñoa") #comuna de residencia
"Cargo"<- c("Mecanico tecnico","Mecanico Lider","Electrico","Supervisor","Mecanico asistente","Mecanico tecnico","Mecanico Lider","Electrico","Supervisor","Mecanico asistente","Mecanico tecnico","Mecanico Lider","Electrico","Supervisor","Mecanico asistente") #cargos
"Antiguedad laboral" <- c(2,5,1,3,4,2,5,1,3,4,2,5,1,3,4) #antiguedad laboral
"Sueldo base"<- c(700000,1500000,1000000,2000000,500000,700000,1500000,1000000,2000000,500000,700000,1500000,1000000,2000000,500000) #sueldo base
"Ingreso a la empresa"<- c(p,q,r,s,t,p,q,r,s,t,p,q,r,s,t)
trabajadoresdestacados <- data.frame(Nombres,`Horas extras diarias`,`Horas de trabajo semanales`,`Comuna de residencia`,Cargo,`Antiguedad laboral`,
`Sueldo base`,`Ingreso a la empresa`)
trabajadoresdestacadosR <- data.frame(rbind(Nombres,`Horas extras diarias`,`Horas de trabajo semanales`,`Comuna de residencia`,Cargo,`Antiguedad laboral`,
`Sueldo base`,`Ingreso a la empresa`))
View(trabajadoresdestacados)
View(trabajadoresdestacadosR)
View(trabajadoresdestacados)
trabajadoresdestacadosC <- data.frame(cbind(Nombres,`Horas extras diarias`,`Horas de trabajo semanales`,`Comuna de residencia`,Cargo,`Antiguedad laboral`,
`Sueldo base`,`Ingreso a la empresa`))
View(trabajadoresdestacadosC)
View(trabajadoresdestacados)
View(trabajadoresdestacadosC)
View(trabajadoresdestacados)
View(trabajadoresdestacados)
View(trabajadoresdestacados)
fix(trabajadoresdestacados)
fix(trabajadoresdestacados)
ls(trabajadoresdestacados) #cuantos obj estan creados
str(trabajadoresdestacados) #estructura de datos
nrow(trabajadoresdestacados) #numero de filas
ncol(trabajadoresdestacados) #numero d columnas
dim(trabajadoresdestacados) #numero de columnas y filas
colnames(trabajadoresdestacados) #nombre de columnas
rownames(trabajadoresdestacados) #nombre de filas
head(trabajadoresdestacados,6) #primeras 6 obs
tail(trabajadoresdestacados,6) #ultomas 6 obs
describe(trabajadoresdestacados) #describe estructura
summary(trabajadoresdestacados) #describe estructura
sapply(trabajadoresdestacados, class)
sapply(trabajadoresdestacados, function(x)length(unique(x)))
summary(trabajadoresdestacados$Horas.extras.diarias)
min(trabajadoresdestacados$Horas.extras.diarias)
max(trabajadoresdestacados$Horas.extras.diarias)
sum(trabajadoresdestacados$Horas.extras.diarias)
quantile(trabajadoresdestacados$Horas.extras.diarias)
quantile(trabajadoresdestacados$Horas.extras.diarias,0.25)
quantile(trabajadoresdestacados$Horas.extras.diarias, na.rm = T, probs = c(0.3,0.6,0.8,0.999))
quantile(trabajadoresdestacados$Horas.extras.diarias, na.rm = T, probs = c(0.3,0.6,0.8,0.999))
quantile(trabajadoresdestacados$Horas.extras.diarias, na.rm = T, probs = c(0.3,0.6,0.8,0.999))
median(trabajadoresdestacados$Horas.extras.diarias)
mean(trabajadoresdestacados$Horas.extras.diarias)
quantile(trabajadoresdestacados$Horas.extras.diarias,0.5)
sd(trabajadoresdestacados$Horas.extras.diarias
)
var(trabajadoresdestacados$Horas.extras.diarias)
IQR(trabajadoresdestacados$Horas.extras.diarias
)
barplot(`Horas extras diarias`, main = "Cantidad de horas extras por trabajador", xlab="trabajadores", ylab = "cantidad de horas", col = "blue")
boxplot(trabajadoresdestacados$Horas.extras.diarias, main="Boxplot horas extras por trabajador",
ylab="canitidad de  horas", col="red")
x <- seq(min(trabajadoresdestacados$Horas.extras.diarias), max(trabajadoresdestacados$Horas.extras.diarias), length.out=60)
y <- seq(min(trabajadoresdestacados$Horas.de.trabajo.semanales), max(trabajadoresdestacados$Horas.de.trabajo.semanales),
length.out=60)
grid <- expand.grid(`Horas extras diarias`=x, `Horas de trabajo semanales`=y)
View(grid)
z <- matrix(grid$`Horas extras diarias` + grid$`Horas de trabajo semanales`, nrow= 60)
contour(x, y, z, main="Gráfico de Contorno de horas extras diarias vs horas de trabajo semanal", xlab="horas extras diarias", ylab="horas de trabajo semanal", col = "green")
hist(trabajadoresdestacados$Horas.extras.diarias, main="Histograma de horas extras", xlab="horas extras diarias")
hist(trabajadoresdestacados$Horas.extras.diarias, main="Histograma de horas extras", xlab="horas extras diarias")
pairs(trabajadoresdestacados[, c("Horas.extras.diarias","Horas.de.trabajo.semanales","Sueldo.base","Antiguedad.laboral")], main="Pares de gráficos de dispersión")
a <-seq(min(trabajadoresdestacados$Horas.extras.diarias), max(trabajadoresdestacados$Horas.extras.diarias), length.out=60)
b <-seq(min(trabajadoresdestacados$Horas.de.trabajo.semanales), max(trabajadoresdestacados$Horas.de.trabajo.semanales),
length.out=60)
c <- outer(a,b, FUN="+")
persp(a, b, c,
main = "Gráfico de Superficie 3D",
xlab = "Horas Extras Diarias",
ylab = "Horas de Trabajo Semanales",
zlab = "Suma de Horas",
col = "lightblue",
theta = 30,  # Ángulo de vista azimutal
phi = 20,    # Ángulo de vista de elevación
expand = 0.6 # Proporción de expansión
)
plot(trabajadoresdestacados$Horas.extras.diarias,trabajadoresdestacados$Horas.de.trabajo.semanales, main="dispersion horas extras / semanales",
xlab = "horas extras diarias", ylab="horas semanales", pch=100, col="blue")
